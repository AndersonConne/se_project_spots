!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_type_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.remove(r.inputErrorClass),o.textContent=""},o=(e,t,o)=>{t.forEach((t=>{r(e,t,o)}))},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?a(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},a=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)};function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?o:r}function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.preventDefault();const o=t.submitter,n=o.textContent;s(o,!0,n,r),e().then((()=>{t.target.reset()})).catch(console.error).finally((()=>{s(o,!1,n)}))}var d=e+"d3610e9c6dce3cb370d8.svg",i=e+"2fc47fd8e9a9bcd9612f.jpg",l=e+"d423b294ea8188f53fb6.svg",u=e+"40608da7369d39bc1077.svg",m=e+"d73f076c46eb5467f5fc.svg";let h,_;const v=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}request(e,t){return fetch(e,t).then(this.checkResponse)}checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getUserInfo(){return this.request(`${this._baseUrl}/users/me`,{headers:this._headers})}editUserInfo(e){let{name:t,about:r}=e;return this.request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})})}getInitialCards(){return this.request(`${this._baseUrl}/cards`,{headers:this._headers})}addNewPost(e){let{link:t,name:r}=e;return this.request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({link:t,name:r})})}deleteCard(e){return this.request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}updateLike(e,t){return this.request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}updateAvatar(e){return this.request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"8c16611b-9dea-425f-bf23-1b84ee0078e3","Content-Type":"application/json"}});v.getAppInfo().then((e=>{let[t,r]=e;console.log(t),t.forEach((e=>{const t=F(e);x.append(t)})),f.src=r.avatar,L.textContent=r.name,C.textContent=r.about})).catch((e=>{console.error(e)})),document.getElementById("image-logo").src=d;const f=document.getElementById("avatar-image");f.src=i,document.getElementById("edit-image").src=l,document.getElementById("plus-image").src=u,document.getElementById("white-pencil").src=m;const y=document.querySelectorAll(".modal__dismiss-button"),p=document.querySelectorAll(".modal"),b=document.querySelector("#edit-modal"),S=b.querySelector("#name"),g=b.querySelector("#description"),q=document.querySelector(".profile__image-btn"),E=document.querySelector(".profile__edit-button"),L=document.querySelector(".profile__name"),k=document.querySelector(".profile__image"),C=document.querySelector(".profile__description"),U=document.forms["edit-profile"],I=document.querySelector("#card__template"),x=document.querySelector(".card__grid-container"),$=document.querySelector("#post-modal"),A=document.querySelector(".profile__add-button"),w=document.querySelector("#add-card-link"),B=document.querySelector("#caption"),P=document.forms["add-card-form"],T=($.querySelector(".modal__submit-button"),document.querySelector("#delete-card-modal")),N=document.forms["delete-modal-form"],j=T.querySelector(".modal__cancel-btn"),D=document.querySelector("#preview-modal"),O=D.querySelector("#preview-image"),J=D.querySelector("#preview-caption"),H=document.querySelector("#avatar-modal"),M=document.forms["avatar-form"],R=H.querySelector("#add-card-link"),z=H.querySelector("#avatar-button");function F(e){const t=I.content.querySelector(".card__content").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like"),a=t.querySelector(".card__delete");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked&&n.classList.add("card_like-color"),n.addEventListener("click",(t=>function(e,t){const r=e.target,o=r.classList.contains("card_like-color");v.updateLike(t,o).then((()=>{r.classList.toggle("card_like-color")})).catch(console.error)}(t,e._id))),a.addEventListener("click",(()=>{!function(e,t){h=e,_=t,console.log(_),G(T)}(t,e._id)})),o.addEventListener("click",(()=>{G(D),O.src=e.link,O.alt=e.name,J.textContent=e.name})),t}function G(e){e.classList.add("modal_open"),document.addEventListener("keydown",Q)}function K(e){e.classList.remove("modal_open"),document.removeEventListener("keydown",Q)}function Q(e){if("Escape"===e.key){const e=document.querySelector(".modal_open");e&&K(e)}}var V;p.forEach((e=>{e.addEventListener("mousedown",(t=>{t.target.classList.contains("modal")&&K(e)}))})),y.forEach((e=>{const t=e.closest(".modal");console.log(t),e.addEventListener("click",(()=>K(t)))})),A.addEventListener("click",(()=>{G($)})),j.addEventListener("click",(()=>K(T))),q.addEventListener("click",(()=>{o(U,[S,g],t),G(H)})),E.addEventListener("click",(()=>{S.value=L.textContent,g.value=C.textContent,o(U,[S,g],t),G(b)})),M.addEventListener("submit",(function(e){c((function(){return v.updateAvatar(R.value).then((e=>{k.src=e.avatar,a(z,t),K(H)}))}),e)})),N.addEventListener("submit",(function(e){c((function(){return v.deleteCard(_).then((()=>{h.remove(),K(T)}))}),e,"Deleting...")})),U.addEventListener("submit",(function(e){c((function(){return v.editUserInfo({name:S.value,about:g.value}).then((e=>{L.textContent=e.name,C.textContent=e.about,K(b)}))}),e)})),P.addEventListener("submit",(function(e){c((function(){return v.addNewPost({link:w.value,name:B.value}).then((r=>{const o=F(r);x.prepend(o),K($),a(e.submitter,t)}))}),e)})),V=t,document.querySelectorAll(V.formSelector).forEach((e=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n(o,a,t),o.forEach((s=>{s.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.add(r.inputErrorClass),o.textContent=t.validationMessage,o.classList.add(r.errorClass)})(e,t,t.validationMessage)})(e,s,t),n(o,a,t)}))}))})(e,V)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBU1YsSUFDakJBLEVBQWEySSxpQkFBaUIsU0FBUyxXQTFDaEJ1QixFQUFDbkssRUFBYUMsRUFBY0MsS0FDaERELEVBQWFlLFNBQVNDLE1BR3pCbEIsRUFBZUMsRUFBYUMsRUFBY0MsR0FuQnZCa0ssRUFBQ3BLLEVBQWFDLEVBQWNDLEtBQ2pELE1BQU1tSyxFQUFzQnJLLEVBQVlJLGNBQ3RDLElBQUlILEVBQWFJLFlBRW5CSixFQUFhSyxVQUFVZSxJQUFJbkIsRUFBT0wsaUJBQ2xDd0ssRUFBb0I3SixZQUFjUCxFQUFhcUssa0JBQy9DRCxFQUFvQi9KLFVBQVVlLElBQUluQixFQUFPSixXQUFXLEVBV2xEc0ssQ0FBZXBLLEVBQWFDLEVBQWNBLEVBQWFxSyxrQkFHekQsRUFzQ0lILENBQW1CbkssRUFBYUMsRUFBY0MsR0FDOUNXLEVBQWtCSCxFQUFXSSxFQUFlWixFQUM5QyxHQUFFLEdBQ0YsRUFNQThKLENBQWlCaEssRUFBYUUsRUFBTyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvaGVscGVycy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvYXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl90eXBlX2luYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcclxufTtcclxuXHJcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuZXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcmVzZXRGb3JtVmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVyID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcclxuICApO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVyKGZvcm1FbGVtZW50LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG4iLCJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uQ29udGVudChcclxuICBidG4sXHJcbiAgaXNMb2FkaW5nLFxyXG4gIGRlZmF1bHRUZXh0ID0gXCJTYXZlXCIsXHJcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXHJcbikge1xyXG4gIGlmIChpc0xvYWRpbmcpIHtcclxuICAgIGJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidG4udGV4dENvbnRlbnQgPSBkZWZhdWx0VGV4dDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVTdWJtaXQocmVxdWVzdCwgZXZ0LCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcclxuICBjb25zdCBpbml0aWFsVGV4dCA9IHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuXHJcbiAgc2V0QnV0dG9uQ29udGVudChzdWJtaXRCdXR0b24sIHRydWUsIGluaXRpYWxUZXh0LCBsb2FkaW5nVGV4dCk7XHJcblxyXG4gIHJlcXVlc3QoKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvbkNvbnRlbnQoc3VibWl0QnV0dG9uLCBmYWxzZSwgaW5pdGlhbFRleHQpO1xyXG4gICAgfSk7XHJcbn1cclxuIiwiaW1wb3J0IHtcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHNldHRpbmdzLFxyXG4gIHJlc2V0Rm9ybVZhbGlkYXRpb24sXHJcbiAgZGlzYWJsZUJ1dHRvbixcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcbmltcG9ydCB7IHNldEJ1dHRvbkNvbnRlbnQsIGhhbmRsZVN1Ym1pdCB9IGZyb20gXCIuLi91dGlscy9oZWxwZXJzLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBpbWFnZUxvZ28gZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xyXG5pbXBvcnQgYXZhdGFySW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XHJcbmltcG9ydCBlZGl0SW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy9lZGl0LnN2Z1wiO1xyXG5pbXBvcnQgcGx1c0ltYWdlIGZyb20gXCIuLi9pbWFnZXMvYWRkLnN2Z1wiO1xyXG5pbXBvcnQgd2hpdGVQZW5jaWwgZnJvbSBcIi4uL2ltYWdlcy93aGl0ZS1wZW5jaWwuc3ZnXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL2FwaS5qc1wiO1xyXG5cclxubGV0IHNlbGVjdGVkQ2FyZCwgc2VsZWN0ZWRDYXJkSWQ7XHJcblxyXG4vLyBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJSZXN0YXVyYW50IHRlcnJhY2VcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIlR1bm5lbCB3aXRoIG1vcm5pbmcgbGlnaHRcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICB9LFxyXG4vLyBdO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiOGMxNjYxMWItOWRlYS00MjVmLWJmMjMtMWI4NGVlMDA3OGUzXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmFwaVxyXG4gIC5nZXRBcHBJbmZvKClcclxuICAudGhlbigoW2NhcmRzLCB1c2VySW5mb10pID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGNhcmRzKTtcclxuICAgIGNhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcclxuICAgICAgY2FyZExpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGF2YXRhckltYWdlcy5zcmMgPSB1c2VySW5mby5hdmF0YXI7XHJcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgfSk7XHJcbi8vIGluaXRpYWxDYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbi8vICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcclxuLy8gICBjYXJkTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4vLyB9KTtcclxuXHJcbi8vIEltYWdlc1xyXG5cclxuY29uc3Qgc3BvdHNMb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZS1sb2dvXCIpO1xyXG5zcG90c0xvZ28uc3JjID0gaW1hZ2VMb2dvO1xyXG5cclxuY29uc3QgYXZhdGFySW1hZ2VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXItaW1hZ2VcIik7XHJcbmF2YXRhckltYWdlcy5zcmMgPSBhdmF0YXJJbWFnZTtcclxuXHJcbmNvbnN0IGVkaXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtaW1hZ2VcIik7XHJcbmVkaXQuc3JjID0gZWRpdEltYWdlO1xyXG5cclxuY29uc3QgcGx1cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGx1cy1pbWFnZVwiKTtcclxucGx1cy5zcmMgPSBwbHVzSW1hZ2U7XHJcblxyXG5jb25zdCB3aGl0ZVBlbmNpbEltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2hpdGUtcGVuY2lsXCIpO1xyXG53aGl0ZVBlbmNpbEltZy5zcmMgPSB3aGl0ZVBlbmNpbDtcclxuXHJcbi8vIFVuaXZlcnNhbCBFbGVtZW50c1xyXG5jb25zdCBhbGxDbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19kaXNtaXNzLWJ1dHRvblwiKTtcclxuY29uc3QgcG9wdXBNb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xyXG5cclxuLy8gUHJvZmlsZSBNb2RhbCBFbGVtZW50c1xyXG5jb25zdCBwcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XHJcbmNvbnN0IGlucHV0TmFtZSA9IHByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI25hbWVcIik7XHJcbmNvbnN0IGlucHV0RGVzY3JpcHRpb24gPSBwcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNkZXNjcmlwdGlvblwiKTtcclxuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2UtYnRuXCIpO1xyXG5cclxuLy8gU2VjdGlvbiAtIFByb2ZpbGUgRWxlbWVudHNcclxuY29uc3QgZWRpdFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlXCJdO1xyXG5cclxuLy8gQ2FyZCBFbGVtZW50c1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmRfX3RlbXBsYXRlXCIpO1xyXG5jb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZ3JpZC1jb250YWluZXJcIik7XHJcblxyXG4vLyBQb3N0IE1vZGFsIEVsZW1lbnRzXHJcbmNvbnN0IG1vZGFsUG9zdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9zdC1tb2RhbFwiKTtcclxuY29uc3QgcG9zdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgbGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rXCIpO1xyXG5jb25zdCBjYXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcHRpb25cIik7XHJcbmNvbnN0IHBvc3RGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcclxuY29uc3QgY2FyZFN1Ym1pdEJ1dHRvbiA9IG1vZGFsUG9zdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCJcclxuKTtcclxuXHJcbi8vIERlbGV0ZSBNb2RhbCBFbGVtZW50c1xyXG5cclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJkZWxldGUtbW9kYWwtZm9ybVwiXTtcclxuY29uc3QgZGVsZXRlQ2FuY2VsQnV0dG9uID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FuY2VsLWJ0blwiKTtcclxuXHJcbi8vIFByZXZpZXcgTW9kYWwgRWxlbWVudHNcclxuXHJcbmNvbnN0IHByZXZpZXdNb2RhbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcclxuY29uc3QgcHJldmlld0ltYWdlID0gcHJldmlld01vZGFsQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld1RleHQgPSBwcmV2aWV3TW9kYWxDb250YWluZXIucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LWNhcHRpb25cIik7XHJcblxyXG4vLyBBdmF0YXIgTW9kYWwgRWxlbWVudHNcclxuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyLWZvcm1cIl07XHJcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rXCIpO1xyXG5jb25zdCBhdmF0YXJTdWJtaXRCdXR0b24gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1idXR0b25cIik7XHJcblxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fY29udGVudFwiKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgY29uc3QgY2FyZE5hbWVFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICBjb25zdCBjYXJkSW1hZ2VFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjb25zdCBjYXJkTGlrZUVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VcIik7XHJcbiAgY29uc3QgZGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGVcIik7XHJcblxyXG4gIGNhcmROYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkSW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEubGluaztcclxuICBjYXJkSW1hZ2VFbGVtZW50LmFsdCA9IGRhdGEubmFtZTtcclxuXHJcbiAgaWYgKGRhdGEuaXNMaWtlZCkge1xyXG4gICAgY2FyZExpa2VFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJjYXJkX2xpa2UtY29sb3JcIik7XHJcbiAgfVxyXG5cclxuICBjYXJkTGlrZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XHJcbiAgICBoYW5kbGVMaWtlQ2xpY2soZXZ0LCBkYXRhLl9pZClcclxuICApO1xyXG4gIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgaGFuZGxlRGVsZXRlKGNhcmRFbGVtZW50LCBkYXRhLl9pZCk7XHJcbiAgfSk7XHJcbiAgY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbENvbnRhaW5lcik7XHJcbiAgICBwcmV2aWV3SW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgcHJldmlld0ltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHByZXZpZXdUZXh0LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIHJldHVybiBhcGkuZGVsZXRlQ2FyZChzZWxlY3RlZENhcmRJZCkudGhlbigoKSA9PiB7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcclxuICAgICAgZGlzbWlzc01vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBldnQsIFwiRGVsZXRpbmcuLi5cIik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZShjYXJkRWxlbWVudCwgY2FyZElkKSB7XHJcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XHJcbiAgY29uc29sZS5sb2coc2VsZWN0ZWRDYXJkSWQpO1xyXG4gIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUF2YXRhcihldnQpIHtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIHJldHVybiBhcGkudXBkYXRlQXZhdGFyKGF2YXRhcklucHV0LnZhbHVlKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVJbWFnZS5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICAgICAgZGlzYWJsZUJ1dHRvbihhdmF0YXJTdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcclxuICAgICAgZGlzbWlzc01vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBldnQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZVN1Ym1pdEZvcm0oZXZ0KSB7XHJcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpXHJcbiAgICAgIC5lZGl0VXNlckluZm8oeyBuYW1lOiBpbnB1dE5hbWUudmFsdWUsIGFib3V0OiBpbnB1dERlc2NyaXB0aW9uLnZhbHVlIH0pXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICAgICAgICBkaXNtaXNzTW9kYWwocHJvZmlsZU1vZGFsKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGV2dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVBvc3RMaW5rRm9ybShldnQpIHtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIHJldHVybiBhcGlcclxuICAgICAgLmFkZE5ld1Bvc3QoeyBsaW5rOiBsaW5rSW5wdXQudmFsdWUsIG5hbWU6IGNhcHRpb25JbnB1dC52YWx1ZSB9KVxyXG4gICAgICAudGhlbigocG9zdCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQocG9zdCk7XHJcbiAgICAgICAgY2FyZExpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICAgICAgZGlzbWlzc01vZGFsKG1vZGFsUG9zdENvbnRhaW5lcik7XHJcbiAgICAgICAgZGlzYWJsZUJ1dHRvbihldnQuc3VibWl0dGVyLCBzZXR0aW5ncyk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBldnQpO1xyXG4gIC8vIGNvbnN0IG5ld1Bvc3QgPSB7IG5hbWU6IGNhcHRpb25JbnB1dC52YWx1ZSwgbGluazogbGlua0lucHV0LnZhbHVlIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhldnQsIGlkKSB7XHJcbiAgY29uc3QgY2FyZExpa2VFbGVtZW50ID0gZXZ0LnRhcmdldDtcclxuICBjb25zdCBpc0xpa2VkID0gY2FyZExpa2VFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfbGlrZS1jb2xvclwiKTtcclxuXHJcbiAgYXBpXHJcbiAgICAudXBkYXRlTGlrZShpZCwgaXNMaWtlZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2FyZExpa2VFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX2xpa2UtY29sb3JcIik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlblwiKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkaXNtaXNzTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlblwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG1vZGFsT3BlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlblwiKTtcclxuICAgIGlmIChtb2RhbE9wZW4pIHtcclxuICAgICAgZGlzbWlzc01vZGFsKG1vZGFsT3Blbik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5wb3B1cE1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xyXG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgICAgZGlzbWlzc01vZGFsKG1vZGFsKTtcclxuICAgIH1cclxuICB9KTtcclxufSk7XHJcblxyXG5hbGxDbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgY29uc3QgcG9wdXAgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcclxuICBjb25zb2xlLmxvZyhwb3B1cCk7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBkaXNtaXNzTW9kYWwocG9wdXApKTtcclxufSk7XHJcblxyXG5wb3N0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKG1vZGFsUG9zdENvbnRhaW5lcik7XHJcbn0pO1xyXG5cclxuZGVsZXRlQ2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBkaXNtaXNzTW9kYWwoZGVsZXRlTW9kYWwpKTtcclxuXHJcbmVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICByZXNldEZvcm1WYWxpZGF0aW9uKGVkaXRGb3JtRWxlbWVudCwgW2lucHV0TmFtZSwgaW5wdXREZXNjcmlwdGlvbl0sIHNldHRpbmdzKTtcclxuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuXHJcbmVkaXRQcm9maWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgaW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgaW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICByZXNldEZvcm1WYWxpZGF0aW9uKGVkaXRGb3JtRWxlbWVudCwgW2lucHV0TmFtZSwgaW5wdXREZXNjcmlwdGlvbl0sIHNldHRpbmdzKTtcclxuICBvcGVuTW9kYWwocHJvZmlsZU1vZGFsKTtcclxufSk7XHJcblxyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlVXBkYXRlQXZhdGFyKTtcclxuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcbmVkaXRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRQcm9maWxlU3VibWl0Rm9ybSk7XHJcbnBvc3RGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVBvc3RMaW5rRm9ybSk7XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgLy8gY29uc3RydWN0b3IgYm9keVxyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcbiAgcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGNoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICAvLyAuLi5cclxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZE5ld1Bvc3QoeyBsaW5rLCBuYW1lIH0pIHtcclxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBsaW5rLFxyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpa2UoaWQsIGlzTGlrZWQpIHtcclxuICAgIHJldHVybiB0aGlzLnJlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxyXG59XHJcblxyXG4vLyBleHBvcnQgdGhlIGNsYXNzXHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsZW1lbnQiLCJpbnB1dEVsZW1lbnQiLCJjb25maWciLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0ZXh0Q29udGVudCIsInJlc2V0Rm9ybVZhbGlkYXRpb24iLCJpbnB1dExpc3QiLCJmb3JFYWNoIiwiaW5wdXQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsInNldEJ1dHRvbkNvbnRlbnQiLCJidG4iLCJpc0xvYWRpbmciLCJkZWZhdWx0VGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImxvYWRpbmdUZXh0IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnV0dG9uIiwic3VibWl0dGVyIiwiaW5pdGlhbFRleHQiLCJ0aGVuIiwidGFyZ2V0IiwicmVzZXQiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJjaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEFwcEluZm8iLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGROZXdQb3N0IiwiX3JlZjMiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsInVwZGF0ZUxpa2UiLCJpc0xpa2VkIiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwidXNlckluZm8iLCJsb2ciLCJpdGVtIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImNhcmRMaXN0IiwiYXBwZW5kIiwiYXZhdGFySW1hZ2VzIiwic3JjIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJlcnIiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW1hZ2VMb2dvIiwiYXZhdGFySW1hZ2UiLCJlZGl0SW1hZ2UiLCJwbHVzSW1hZ2UiLCJ3aGl0ZVBlbmNpbCIsImFsbENsb3NlQnV0dG9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwb3B1cE1vZGFscyIsInByb2ZpbGVNb2RhbCIsImlucHV0TmFtZSIsImlucHV0RGVzY3JpcHRpb24iLCJlZGl0QXZhdGFyQnV0dG9uIiwiZWRpdFByb2ZpbGUiLCJwcm9maWxlSW1hZ2UiLCJlZGl0Rm9ybUVsZW1lbnQiLCJmb3JtcyIsImNhcmRUZW1wbGF0ZSIsIm1vZGFsUG9zdENvbnRhaW5lciIsInBvc3RCdXR0b24iLCJsaW5rSW5wdXQiLCJjYXB0aW9uSW5wdXQiLCJwb3N0Rm9ybUVsZW1lbnQiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJkZWxldGVDYW5jZWxCdXR0b24iLCJwcmV2aWV3TW9kYWxDb250YWluZXIiLCJwcmV2aWV3SW1hZ2UiLCJwcmV2aWV3VGV4dCIsImF2YXRhck1vZGFsIiwiYXZhdGFyRm9ybSIsImF2YXRhcklucHV0IiwiYXZhdGFyU3VibWl0QnV0dG9uIiwiZGF0YSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsZW1lbnQiLCJjYXJkSW1hZ2VFbGVtZW50IiwiY2FyZExpa2VFbGVtZW50IiwiZGVsZXRlQnV0dG9uIiwiYWx0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbnRhaW5zIiwidG9nZ2xlIiwiaGFuZGxlTGlrZUNsaWNrIiwiX2lkIiwiY2FyZElkIiwib3Blbk1vZGFsIiwiaGFuZGxlRGVsZXRlIiwibW9kYWwiLCJoYW5kbGVFc2NhcGUiLCJkaXNtaXNzTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwibW9kYWxPcGVuIiwiYnV0dG9uIiwicG9wdXAiLCJjbG9zZXN0IiwidmFsdWUiLCJwb3N0IiwicHJlcGVuZCIsInNldEV2ZW50TGlzdGVuZXIiLCJBcnJheSIsImZyb20iLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZUVsZW1lbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=